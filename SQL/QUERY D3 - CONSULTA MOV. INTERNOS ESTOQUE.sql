
/* MOV. INTERNO CONSULTA ''ANALITICO''*/
SELECT D3_ZZLOTE, *  
FROM SD3010
WHERE D3_ZZLOTE LIKE '1811%'
AND D3_TM = '040'
AND D3_CC = '4010'
AND D3_ESTORNO <> 'S' 
AND D3_EMISSAO BETWEEN '20181126' AND '20181126'
GO

/* SOMA QUANTIDADE ENTRADA POR PRODUTO NO PERÍODO + DESCRIÇÃO DO PRODUTO */
SELECT SD3.D3_COD, 
	   SB1.B1_DESC,
       SUM(SD3.D3_QUANT) AS QTDE,
       "EMISSAO" = ''       
FROM SD3010 SD3
INNER JOIN SB1010 SB1 ON SB1.B1_COD = SD3.D3_COD
WHERE SD3.D3_ZZLOTE LIKE '1811%'
AND SD3.D3_TM = '040'
AND SD3.D3_CC = '4010'
AND SD3.D3_ESTORNO <> 'S' 
AND SD3.D3_EMISSAO BETWEEN '20181114' AND '20181114'
GROUP BY SD3.D3_COD,
         SB1.B1_DESC
GO

/* SOMA QUANTIDADE ENTRADA POR PRODUTO NO PERÍODO */
SELECT SD3.D3_COD, 
       SUM(SD3.D3_QUANT) AS QTDE        
FROM SD3010 SD3
WHERE SD3.D3_ZZLOTE LIKE '1811%'
AND SD3.D3_TM = '040'
AND SD3.D3_CC = '4010'
AND SD3.D3_ESTORNO <> 'S' 
AND SD3.D3_EMISSAO BETWEEN '20181114' AND '20181114'
GROUP BY SD3.D3_COD
GO

/* TOTAL DE CAIXAS NO PERÍODO */
SELECT SUM(SD3.D3_QUANT) AS QTDE        
FROM SD3010 SD3
WHERE SD3.D3_ZZLOTE LIKE '1811%'
AND SD3.D3_TM = '040'
AND SD3.D3_CC = '4010'
AND SD3.D3_ESTORNO <> 'SB1' 
AND SD3.D3_EMISSAO BETWEEN '20181101' AND '20181130'
GO