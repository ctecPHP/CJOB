USE Protheus_Producao
GO

SELECT SUM(C6_QTDVEN) AS "TCX_ROMANEIO"
FROM SC6040 
WHERE C6_NUM IN (SELECT C5_NUM FROM SC5040 WHERE C5_ROMANEI = '002614' AND D_E_L_E_T_ = '')
AND D_E_L_E_T_ = ''
GO

SELECT SUM(D2_QUANT) AS "TCX_NF" 
FROM SD2040 
WHERE D2_PEDIDO IN (SELECT C5_NUM FROM SC5040 WHERE C5_ROMANEI = '002614')
AND D_E_L_E_T_ = ''
GO



SET DATEFORMAT ymd
SELECT SC5.C5_NUM,
       SC5.C5_ROMANEI,
	   SC5.C5_QTDPED,
	   SC5.C5_ESPECI1,
	   SC5.C5_EMISSAO  	   
FROM SC5010 SC5
WHERE SC5.C5_EMISSAO BETWEEN '20181101' AND GETDATE()
AND SC5.C5_NOTA <> ''
AND SC5.D_E_L_E_T_ = ''
AND SC5.C5_ZZTIPO <> 'L'
AND SC5.C5_ROMANEI <> ''
AND SC5.C5_STAPED = 'F'
GO



/*sobel*/
SET DATEFORMAT ymd
SELECT SC5.C5_NUM,
       SC5.C5_NOTA,
	   SD2.D2_DOC,
       SC5.C5_ROMANEI,
	   SC5.C5_QTDPED,
	   SC5.C5_ESPECI1,
	   SC5.C5_EMISSAO,
	   SUM(SD2.D2_QUANT) AS QTDNF	   	   
FROM SC5040 SC5
INNER JOIN SD2040 SD2 ON SD2.D2_PEDIDO = SC5.C5_NUM 
WHERE SC5.C5_EMISSAO BETWEEN '20181101' AND GETDATE()
AND SC5.C5_NOTA <> ''
AND SC5.D_E_L_E_T_ = ''
AND SD2.D_E_L_E_T_ = ''
AND SC5.C5_ZZTIPO <> 'L'
AND SC5.C5_ROMANEI <> ''
AND SC5.C5_STAPED = 'F'
GROUP BY SC5.C5_NUM,
         SC5.C5_NOTA,
	     SD2.D2_DOC,
         SC5.C5_ROMANEI,
	     SC5.C5_QTDPED,
	     SC5.C5_ESPECI1,
	     SC5.C5_EMISSAO,
	     SD2.D2_QUANT	   
GO














/*ROMANEIO PROBLEMA 002183*/
	
SELECT DISTINCT C5_ROMANEI FROM SC5040 WHERE C5_ROMANEI <> ''
GO 

SELECT DISTINCT C5_ROMANEI FROM SC5040 WHERE
C5_ROMANEI <> ''
AND C5_NOTA <> ''
AND D_E_L_E_T_ = ''
GO 

SELECT C5_NOTA, * 
FROM SC5040
WHERE C5_ROMANEI = '001907'
GO

SELECT D2_QUANT FROM SD2040 
WHERE D2_DOC = '001328'
GO
-- 388 +
---  6
--- 188

SELECT * FROM SC5040 
WHERE C5_NUM = '092752'
GO
